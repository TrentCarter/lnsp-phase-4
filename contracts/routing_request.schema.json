{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Routing Request Schema",
  "description": "Schema for routing requests through the Gateway to appropriate providers",
  "type": "object",
  "required": [
    "request_id",
    "agent",
    "requirements"
  ],
  "properties": {
    "request_id": {
      "type": "string",
      "description": "Unique request identifier (e.g., 'req-abc123')",
      "minLength": 1,
      "maxLength": 100
    },
    "run_id": {
      "type": "string",
      "description": "Optional run identifier for grouping requests (e.g., 'R-001')",
      "minLength": 1,
      "maxLength": 100
    },
    "agent": {
      "type": "string",
      "description": "Agent making the request (e.g., 'Worker-CPE-5')",
      "minLength": 1,
      "maxLength": 100
    },
    "requirements": {
      "type": "object",
      "description": "Provider requirements for this request",
      "required": ["model"],
      "properties": {
        "model": {
          "type": "string",
          "description": "Required model name (e.g., 'gpt-4', 'claude-sonnet-3.5')",
          "minLength": 1
        },
        "context_window": {
          "type": "integer",
          "description": "Minimum context window size required",
          "minimum": 1
        },
        "features": {
          "type": "array",
          "description": "Required features",
          "items": {
            "type": "string"
          }
        }
      }
    },
    "budget": {
      "type": "object",
      "description": "Optional budget constraints",
      "properties": {
        "max_cost_usd": {
          "type": "number",
          "description": "Maximum cost in USD for this request",
          "minimum": 0,
          "exclusiveMinimum": true
        },
        "max_latency_ms": {
          "type": "integer",
          "description": "Maximum acceptable latency in milliseconds",
          "minimum": 1
        }
      }
    },
    "optimization": {
      "type": "string",
      "description": "Optimization strategy for provider selection",
      "enum": ["cost", "latency", "balanced"],
      "default": "cost"
    },
    "payload": {
      "type": "object",
      "description": "Actual request payload to forward to the provider",
      "properties": {
        "messages": {
          "type": "array",
          "description": "Chat messages for completion",
          "items": {
            "type": "object",
            "required": ["role", "content"],
            "properties": {
              "role": {
                "type": "string",
                "enum": ["system", "user", "assistant"]
              },
              "content": {
                "type": "string"
              }
            }
          }
        },
        "temperature": {
          "type": "number",
          "minimum": 0,
          "maximum": 2
        },
        "max_tokens": {
          "type": "integer",
          "minimum": 1
        }
      }
    }
  }
}
