{
  "model_type": "memory_gru",
  "model_name": "Memory-Augmented GRU (Extended Context)",
  "history": [
    {
      "epoch": 1,
      "train_loss": 0.3565917043731763,
      "train_cosine": 0.3529049512476496,
      "val_loss": 0.30768587523036534,
      "val_cosine": 0.44388696551322937,
      "lr": 0.0001,
      "hit@1": 0.49640288949012756,
      "hit@5": 0.7050359845161438,
      "hit@10": 0.769784152507782
    },
    {
      "epoch": 2,
      "train_loss": 0.3162668840243266,
      "train_cosine": 0.43506535448324957,
      "val_loss": 0.2902807684408294,
      "val_cosine": 0.4812474515702989,
      "lr": 9.990754267376514e-05
    },
    {
      "epoch": 3,
      "train_loss": 0.30366127040141666,
      "train_cosine": 0.4615787454904656,
      "val_loss": 0.28399357861942714,
      "val_cosine": 0.4945997479889128,
      "lr": 9.963055062204608e-05
    },
    {
      "epoch": 4,
      "train_loss": 0.2989306006676111,
      "train_cosine": 0.4716421742087757,
      "val_loss": 0.281640597515636,
      "val_cosine": 0.499479740858078,
      "lr": 9.917016206459795e-05
    },
    {
      "epoch": 5,
      "train_loss": 0.2959874589473773,
      "train_cosine": 0.4769245815964843,
      "val_loss": 0.28021708793110317,
      "val_cosine": 0.5017734418312708,
      "lr": 9.852826883675633e-05
    },
    {
      "epoch": 6,
      "train_loss": 0.2929251605692582,
      "train_cosine": 0.4812536789820745,
      "val_loss": 0.2789391560686959,
      "val_cosine": 0.5032710764143202,
      "lr": 9.770750861548009e-05,
      "hit@1": 0.4748201370239258,
      "hit@5": 0.6978417038917542,
      "hit@10": 0.7410072088241577
    },
    {
      "epoch": 7,
      "train_loss": 0.2900565744210512,
      "train_cosine": 0.4837745941984348,
      "val_loss": 0.2789413556456566,
      "val_cosine": 0.5004245224926207,
      "lr": 9.671125408057097e-05,
      "hit@1": 0.5035971403121948,
      "hit@5": 0.7194244861602783,
      "hit@10": 0.7553957104682922
    },
    {
      "epoch": 8,
      "train_loss": 0.28657906445173115,
      "train_cosine": 0.4855135730825938,
      "val_loss": 0.2783984790245692,
      "val_cosine": 0.5001902961068683,
      "lr": 9.554359905560885e-05
    },
    {
      "epoch": 9,
      "train_loss": 0.28345573120392287,
      "train_cosine": 0.48906543717170353,
      "val_loss": 0.27793479214111966,
      "val_cosine": 0.4998966207106908,
      "lr": 9.420934168555251e-05
    },
    {
      "epoch": 10,
      "train_loss": 0.2796768526045176,
      "train_cosine": 0.49309339374303823,
      "val_loss": 0.2772403922345903,
      "val_cosine": 0.5005654394626617,
      "lr": 9.27139647201328e-05
    },
    {
      "epoch": 11,
      "train_loss": 0.27600349887059283,
      "train_cosine": 0.4975508617667053,
      "val_loss": 0.2767565722266833,
      "val_cosine": 0.5002764529652066,
      "lr": 9.106361298405804e-05,
      "hit@1": 0.5035971403121948,
      "hit@5": 0.7410072088241577,
      "hit@10": 0.7625899314880371
    },
    {
      "epoch": 12,
      "train_loss": 0.2723445653533324,
      "train_cosine": 0.5015004126307293,
      "val_loss": 0.27709313564830357,
      "val_cosine": 0.49876534442106885,
      "lr": 8.926506812661104e-05
    },
    {
      "epoch": 13,
      "train_loss": 0.2681574608461979,
      "train_cosine": 0.5058477371931075,
      "val_loss": 0.27670325007703567,
      "val_cosine": 0.4992730799648497,
      "lr": 8.732572075439773e-05
    },
    {
      "epoch": 14,
      "train_loss": 0.26561272889375687,
      "train_cosine": 0.5096087495868022,
      "val_loss": 0.2774588738878568,
      "val_cosine": 0.4966004656420814,
      "lr": 8.525354006175925e-05
    },
    {
      "epoch": 15,
      "train_loss": 0.2614154528157833,
      "train_cosine": 0.5145085990811005,
      "val_loss": 0.27785228027237785,
      "val_cosine": 0.4952552003992928,
      "lr": 8.305704108364301e-05
    },
    {
      "epoch": 16,
      "train_loss": 0.2581025416461321,
      "train_cosine": 0.5184916299887191,
      "val_loss": 0.27825703885820174,
      "val_cosine": 0.4949589752488666,
      "lr": 8.074524970549764e-05,
      "hit@1": 0.5179855823516846,
      "hit@5": 0.7338129281997681,
      "hit@10": 0.7769784331321716
    },
    {
      "epoch": 17,
      "train_loss": 0.25456688791895526,
      "train_cosine": 0.5226035521198539,
      "val_loss": 0.2777818797363175,
      "val_cosine": 0.4961189379294713,
      "lr": 7.832766557397364e-05,
      "hit@1": 0.5035971403121948,
      "hit@5": 0.7338129281997681,
      "hit@10": 0.7769784331321716
    },
    {
      "epoch": 18,
      "train_loss": 0.2515714106460412,
      "train_cosine": 0.5270167558621137,
      "val_loss": 0.27976392540666795,
      "val_cosine": 0.4899703959623973,
      "lr": 7.58142230608376e-05,
      "hit@1": 0.5323740839958191,
      "hit@5": 0.7482014298439026,
      "hit@10": 0.7769784331321716
    },
    {
      "epoch": 19,
      "train_loss": 0.24839125296626335,
      "train_cosine": 0.5314364993037318,
      "val_loss": 0.27962855166859096,
      "val_cosine": 0.49069444007343715,
      "lr": 7.321525044050772e-05
    },
    {
      "epoch": 20,
      "train_loss": 0.24519787948483077,
      "train_cosine": 0.5352399309094136,
      "val_loss": 0.27979816248019534,
      "val_cosine": 0.4915352298153771,
      "lr": 7.054142744895887e-05
    },
    {
      "epoch": 21,
      "train_loss": 0.2426271701279359,
      "train_cosine": 0.5390565815644387,
      "val_loss": 0.2802376200755437,
      "val_cosine": 0.49016575349701774,
      "lr": 6.780374139839648e-05,
      "hit@1": 0.5395683646202087,
      "hit@5": 0.7410072088241577,
      "hit@10": 0.7769784331321716
    },
    {
      "epoch": 22,
      "train_loss": 0.2401391167480212,
      "train_cosine": 0.5432022118415589,
      "val_loss": 0.28211337079604465,
      "val_cosine": 0.4854976667298211,
      "lr": 6.501344202803417e-05,
      "hit@1": 0.5395683646202087,
      "hit@5": 0.7410072088241577,
      "hit@10": 0.7841726541519165
    }
  ],
  "best_hit5": 0.7482014298439026,
  "stopped_epoch": 23,
  "args": {
    "model_type": "memory_gru",
    "data": "artifacts/lvm/data_phase3_retry/training_sequences_ctx100.npz",
    "epochs": 50,
    "batch_size": 8,
    "accumulation_steps": 32,
    "lr": 0.0001,
    "weight_decay": 0.0001,
    "device": "mps",
    "patience": 3,
    "alpha_infonce": 0.03,
    "temperature": 0.07,
    "min_coherence": 0.0,
    "min_length": 7,
    "output_dir": "artifacts/lvm/models_phase3_retry/run_1000ctx_final",
    "seed": 42
  },
  "trained_at": "2025-10-20T09:07:21.302216"
}