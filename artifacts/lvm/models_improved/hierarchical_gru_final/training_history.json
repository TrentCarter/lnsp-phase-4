{
  "model_type": "hierarchical_gru",
  "model_name": "Hierarchical GRU (Extended Context)",
  "history": [
    {
      "epoch": 1,
      "train_loss": 0.2796597546514343,
      "train_cosine": 0.2799507273292067,
      "val_loss": 0.13875487094952,
      "val_cosine": 0.47240534755918717,
      "lr": 0.0005,
      "hit@1": 0.01653611846268177,
      "hit@5": 0.050478678196668625,
      "hit@10": 0.08093994855880737
    },
    {
      "epoch": 2,
      "train_loss": 0.11956137485640705,
      "train_cosine": 0.5354116209335741,
      "val_loss": 0.12047398514631721,
      "val_cosine": 0.5326447333726618,
      "lr": 0.0005
    },
    {
      "epoch": 3,
      "train_loss": 0.10879682864843876,
      "train_cosine": 0.5741992174840933,
      "val_loss": 0.11415859229034847,
      "val_cosine": 0.554944646027353,
      "lr": 0.0005
    },
    {
      "epoch": 4,
      "train_loss": 0.10411206712433059,
      "train_cosine": 0.5917804959942313,
      "val_loss": 0.11110043463607629,
      "val_cosine": 0.5661035105586052,
      "lr": 0.0005
    },
    {
      "epoch": 5,
      "train_loss": 0.10134356884118573,
      "train_cosine": 0.6022194265027533,
      "val_loss": 0.10909548163827923,
      "val_cosine": 0.5734314256244235,
      "lr": 0.0005
    },
    {
      "epoch": 6,
      "train_loss": 0.09954817267855623,
      "train_cosine": 0.6089060061118182,
      "val_loss": 0.10773050774716669,
      "val_cosine": 0.5784656960103247,
      "lr": 0.0005,
      "hit@1": 0.009573542512953281,
      "hit@5": 0.029590949416160583,
      "hit@10": 0.05918189883232117
    },
    {
      "epoch": 7,
      "train_loss": 0.09826880831836547,
      "train_cosine": 0.6138093747406183,
      "val_loss": 0.10718741185135311,
      "val_cosine": 0.580403572983212,
      "lr": 0.0005
    },
    {
      "epoch": 8,
      "train_loss": 0.09727633901332554,
      "train_cosine": 0.6174716576703193,
      "val_loss": 0.10655318117803997,
      "val_cosine": 0.5828316882252693,
      "lr": 0.0005
    },
    {
      "epoch": 9,
      "train_loss": 0.09651460051075224,
      "train_cosine": 0.6204322721382413,
      "val_loss": 0.10607043446766005,
      "val_cosine": 0.5845000131262673,
      "lr": 0.0005
    },
    {
      "epoch": 10,
      "train_loss": 0.09590504003613726,
      "train_cosine": 0.622748823173275,
      "val_loss": 0.10582941604985131,
      "val_cosine": 0.5854560674892532,
      "lr": 0.0005
    },
    {
      "epoch": 11,
      "train_loss": 0.09540439898799817,
      "train_cosine": 0.6246531216352716,
      "val_loss": 0.10549659706238243,
      "val_cosine": 0.5867248434159491,
      "lr": 0.0005,
      "hit@1": 0.009573542512953281,
      "hit@5": 0.03307223692536354,
      "hit@10": 0.05744125321507454
    },
    {
      "epoch": 12,
      "train_loss": 0.09486546840276512,
      "train_cosine": 0.6267344946093604,
      "val_loss": 0.10514839324686262,
      "val_cosine": 0.5880044723550478,
      "lr": 0.0005
    },
    {
      "epoch": 13,
      "train_loss": 0.09450709974341348,
      "train_cosine": 0.6280856986902078,
      "val_loss": 0.10451904063423474,
      "val_cosine": 0.5903549384739664,
      "lr": 0.0005
    },
    {
      "epoch": 14,
      "train_loss": 0.09417793937834792,
      "train_cosine": 0.6293319955514312,
      "val_loss": 0.10449082921776506,
      "val_cosine": 0.5904023465183046,
      "lr": 0.0005
    },
    {
      "epoch": 15,
      "train_loss": 0.0939298693909549,
      "train_cosine": 0.6304952284499957,
      "val_loss": 0.10443371461911334,
      "val_cosine": 0.5906494234999021,
      "lr": 0.0005
    },
    {
      "epoch": 16,
      "train_loss": 0.09362901736846649,
      "train_cosine": 0.6315537396783799,
      "val_loss": 0.10420863123403655,
      "val_cosine": 0.5914991829130385,
      "lr": 0.0005,
      "hit@1": 0.009573542512953281,
      "hit@5": 0.038294170051813126,
      "hit@10": 0.05744125321507454
    },
    {
      "epoch": 17,
      "train_loss": 0.09337975099775075,
      "train_cosine": 0.6324385412890845,
      "val_loss": 0.10424697771668434,
      "val_cosine": 0.5913258997930421,
      "lr": 0.0005
    },
    {
      "epoch": 18,
      "train_loss": 0.09312508647379122,
      "train_cosine": 0.633327161010943,
      "val_loss": 0.10395991843607691,
      "val_cosine": 0.5924005996849802,
      "lr": 0.0005
    },
    {
      "epoch": 19,
      "train_loss": 0.09293256462450736,
      "train_cosine": 0.6341291372621023,
      "val_loss": 0.10400283698820406,
      "val_cosine": 0.5922433369689517,
      "lr": 0.0005
    },
    {
      "epoch": 20,
      "train_loss": 0.09277204681337803,
      "train_cosine": 0.6347354062755042,
      "val_loss": 0.10367694186667602,
      "val_cosine": 0.5934811623560058,
      "lr": 0.0005,
      "hit@1": 0.008703220635652542,
      "hit@5": 0.032201915979385376,
      "hit@10": 0.06005221977829933
    }
  ],
  "best_val_loss": 0.10367694186667602,
  "best_hit5": 0.050478678196668625,
  "args": {
    "model_type": "hierarchical_gru",
    "data": "artifacts/lvm/data_extended/training_sequences_ctx100.npz",
    "epochs": 20,
    "batch_size": 16,
    "lr": 0.0005,
    "device": "mps",
    "delta_mode": true,
    "coherence_threshold": 0.0,
    "train_ratio": 0.9,
    "lambda_mse": 1.0,
    "lambda_cosine": 0.5,
    "lambda_infonce": 0.1,
    "temperature": 0.07,
    "output_dir": "artifacts/lvm/models_improved/hierarchical_gru_final",
    "seed": 42
  },
  "trained_at": "2025-10-19T15:02:48.197543"
}