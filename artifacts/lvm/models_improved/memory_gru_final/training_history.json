{
  "model_type": "memory_gru",
  "model_name": "Memory-Augmented GRU (Extended Context)",
  "history": [
    {
      "epoch": 1,
      "train_loss": 0.531477722682451,
      "train_cosine": -0.00016244969859372554,
      "val_loss": 0.529809930258327,
      "val_cosine": 0.00020177693396463938,
      "lr": 0.0005,
      "hit@1": 0.35596171021461487,
      "hit@5": 0.5117493271827698,
      "hit@10": 0.5805047750473022
    },
    {
      "epoch": 2,
      "train_loss": 0.5303953220785218,
      "train_cosine": 9.954483834424722e-05,
      "val_loss": 0.5303435002764066,
      "val_cosine": -7.901839692042106e-05,
      "lr": 0.0005
    },
    {
      "epoch": 3,
      "train_loss": 0.5301628134014437,
      "train_cosine": 5.403508368865861e-05,
      "val_loss": 0.5298669586579005,
      "val_cosine": -0.00031025755318599596,
      "lr": 0.0005
    },
    {
      "epoch": 4,
      "train_loss": 0.5299825582526416,
      "train_cosine": 0.00018639652389481926,
      "val_loss": 0.5298536287413703,
      "val_cosine": -0.0002274423127851656,
      "lr": 0.0005
    },
    {
      "epoch": 5,
      "train_loss": 0.529880040847111,
      "train_cosine": 0.0003403138803671714,
      "val_loss": 0.5299790832731459,
      "val_cosine": -0.00030436328294551157,
      "lr": 0.00025
    },
    {
      "epoch": 6,
      "train_loss": 0.5289139057460585,
      "train_cosine": 0.0015530535540063779,
      "val_loss": 0.5314002823498514,
      "val_cosine": -0.0007487116587678125,
      "lr": 0.00025,
      "hit@1": 0.3507397770881653,
      "hit@5": 0.5091384053230286,
      "hit@10": 0.5770235061645508
    },
    {
      "epoch": 7,
      "train_loss": 0.5278654216612825,
      "train_cosine": 0.0029137407723888497,
      "val_loss": 0.5304436932007471,
      "val_cosine": -0.00031106654892533296,
      "lr": 0.00025
    },
    {
      "epoch": 8,
      "train_loss": 0.5215945079599741,
      "train_cosine": 0.010335901287939736,
      "val_loss": 0.5155787136819627,
      "val_cosine": 0.017739915845191315,
      "lr": 0.00025
    },
    {
      "epoch": 9,
      "train_loss": 0.4995983939606339,
      "train_cosine": 0.03827528856336442,
      "val_loss": 0.5005702881349458,
      "val_cosine": 0.03937935954632445,
      "lr": 0.00025
    },
    {
      "epoch": 10,
      "train_loss": 0.48631048331688803,
      "train_cosine": 0.055330811004981904,
      "val_loss": 0.4931885591811604,
      "val_cosine": 0.050387473958027035,
      "lr": 0.00025
    },
    {
      "epoch": 11,
      "train_loss": 0.4753925611636956,
      "train_cosine": 0.06820564347841192,
      "val_loss": 0.49123700418406063,
      "val_cosine": 0.05546618317667809,
      "lr": 0.00025,
      "hit@1": 0.2845953106880188,
      "hit@5": 0.4281984269618988,
      "hit@10": 0.4891209602355957
    },
    {
      "epoch": 12,
      "train_loss": 0.4642202922895597,
      "train_cosine": 0.08032954128418729,
      "val_loss": 0.4861944607562489,
      "val_cosine": 0.06635951398250957,
      "lr": 0.00025
    },
    {
      "epoch": 13,
      "train_loss": 0.45464944405821456,
      "train_cosine": 0.09055718128503107,
      "val_loss": 0.48541052266955376,
      "val_cosine": 0.07032926077954471,
      "lr": 0.00025
    },
    {
      "epoch": 14,
      "train_loss": 0.4452675744752766,
      "train_cosine": 0.10028741648853194,
      "val_loss": 0.48395491018891335,
      "val_cosine": 0.07187139438206537,
      "lr": 0.00025
    },
    {
      "epoch": 15,
      "train_loss": 0.434021345786635,
      "train_cosine": 0.10976881265132789,
      "val_loss": 0.4794609472155571,
      "val_cosine": 0.08010342210117313,
      "lr": 0.00025
    },
    {
      "epoch": 16,
      "train_loss": 0.42101356336391377,
      "train_cosine": 0.12103340826674881,
      "val_loss": 0.47539009360803497,
      "val_cosine": 0.08554378353680174,
      "lr": 0.00025,
      "hit@1": 0.25935596227645874,
      "hit@5": 0.401218444108963,
      "hit@10": 0.4551784098148346
    },
    {
      "epoch": 17,
      "train_loss": 0.4079188025403687,
      "train_cosine": 0.13189537015861771,
      "val_loss": 0.4697171114385128,
      "val_cosine": 0.09094342020236784,
      "lr": 0.00025
    },
    {
      "epoch": 18,
      "train_loss": 0.39620622992515564,
      "train_cosine": 0.14202930012446807,
      "val_loss": 0.46624867038594353,
      "val_cosine": 0.09253975645535523,
      "lr": 0.00025
    },
    {
      "epoch": 19,
      "train_loss": 0.3826307620241915,
      "train_cosine": 0.15235680991051367,
      "val_loss": 0.4604453837705983,
      "val_cosine": 0.09679244184452626,
      "lr": 0.00025
    },
    {
      "epoch": 20,
      "train_loss": 0.3718288389983192,
      "train_cosine": 0.16192167455290124,
      "val_loss": 0.4580053670538796,
      "val_cosine": 0.10195753024891019,
      "lr": 0.00025,
      "hit@1": 0.23759791254997253,
      "hit@5": 0.3698868453502655,
      "hit@10": 0.42732810974121094
    }
  ],
  "best_val_loss": 0.4580053670538796,
  "best_hit5": 0.5117493271827698,
  "args": {
    "model_type": "memory_gru",
    "data": "artifacts/lvm/data_extended/training_sequences_ctx100.npz",
    "epochs": 20,
    "batch_size": 16,
    "lr": 0.0005,
    "device": "mps",
    "delta_mode": true,
    "coherence_threshold": 0.0,
    "train_ratio": 0.9,
    "lambda_mse": 1.0,
    "lambda_cosine": 0.5,
    "lambda_infonce": 0.1,
    "temperature": 0.07,
    "output_dir": "artifacts/lvm/models_improved/memory_gru_final",
    "seed": 42
  },
  "trained_at": "2025-10-19T15:18:01.141079"
}