{
  "model_type": "memory_gru",
  "model_name": "Memory-Augmented GRU (Extended Context)",
  "history": [
    {
      "epoch": 1,
      "train_loss": 0.398175912636977,
      "train_cosine": 0.3665413064452318,
      "val_loss": 0.3634319563706716,
      "val_cosine": 0.4350903034210205,
      "lr": 0.0001,
      "hit@1": 0.40869563817977905,
      "hit@5": 0.582608699798584,
      "hit@10": 0.643478274345398
    },
    {
      "epoch": 2,
      "train_loss": 0.36045789879101975,
      "train_cosine": 0.44459527111970476,
      "val_loss": 0.35225977301597594,
      "val_cosine": 0.4582487285137177,
      "lr": 9.990754267376514e-05
    },
    {
      "epoch": 3,
      "train_loss": 0.35123516160708207,
      "train_cosine": 0.45979813818748155,
      "val_loss": 0.3476018210252126,
      "val_cosine": 0.46127264698346454,
      "lr": 9.963055062204608e-05
    },
    {
      "epoch": 4,
      "train_loss": 0.3434928011435729,
      "train_cosine": 0.4622166262223171,
      "val_loss": 0.34421127041180927,
      "val_cosine": 0.4568287948767344,
      "lr": 9.917016206459795e-05
    },
    {
      "epoch": 5,
      "train_loss": 0.3356071137464963,
      "train_cosine": 0.4638883893306438,
      "val_loss": 0.3398222406705221,
      "val_cosine": 0.45870067874590553,
      "lr": 9.852826883675633e-05
    },
    {
      "epoch": 6,
      "train_loss": 0.3260130868508266,
      "train_cosine": 0.47323161730399504,
      "val_loss": 0.3365404367446899,
      "val_cosine": 0.4602732499440511,
      "lr": 9.770750861548009e-05,
      "hit@1": 0.4434782564640045,
      "hit@5": 0.634782612323761,
      "hit@10": 0.686956524848938
    },
    {
      "epoch": 7,
      "train_loss": 0.3195417421368452,
      "train_cosine": 0.47719545799952284,
      "val_loss": 0.33486225207646686,
      "val_cosine": 0.45992117524147036,
      "lr": 9.671125408057097e-05
    },
    {
      "epoch": 8,
      "train_loss": 0.31127903472918733,
      "train_cosine": 0.48311038819643176,
      "val_loss": 0.33369985818862913,
      "val_cosine": 0.45926320751508076,
      "lr": 9.554359905560885e-05
    },
    {
      "epoch": 9,
      "train_loss": 0.3061233366911228,
      "train_cosine": 0.4865215161672006,
      "val_loss": 0.33344132304191587,
      "val_cosine": 0.45696746508280434,
      "lr": 9.420934168555251e-05
    },
    {
      "epoch": 10,
      "train_loss": 0.2999153584241867,
      "train_cosine": 0.4924186121958953,
      "val_loss": 0.33415260712305705,
      "val_cosine": 0.4556913713614146,
      "lr": 9.27139647201328e-05
    },
    {
      "epoch": 11,
      "train_loss": 0.29392693352240784,
      "train_cosine": 0.49670388285930356,
      "val_loss": 0.33355883955955506,
      "val_cosine": 0.45468571186065676,
      "lr": 9.106361298405804e-05,
      "hit@1": 0.47826087474823,
      "hit@5": 0.665217399597168,
      "hit@10": 0.7130434513092041
    },
    {
      "epoch": 12,
      "train_loss": 0.2890023459608738,
      "train_cosine": 0.500999843615752,
      "val_loss": 0.33420858581860863,
      "val_cosine": 0.4525919715563456,
      "lr": 8.926506812661104e-05
    },
    {
      "epoch": 13,
      "train_loss": 0.2833787757616777,
      "train_cosine": 0.506781586087667,
      "val_loss": 0.3355364720026652,
      "val_cosine": 0.44992860953013103,
      "lr": 8.732572075439773e-05
    },
    {
      "epoch": 14,
      "train_loss": 0.2777929769112514,
      "train_cosine": 0.5128391701441546,
      "val_loss": 0.3362854242324829,
      "val_cosine": 0.44645942449569703,
      "lr": 8.525354006175925e-05
    },
    {
      "epoch": 15,
      "train_loss": 0.2731697779435378,
      "train_cosine": 0.5167661274854953,
      "val_loss": 0.3366825799147288,
      "val_cosine": 0.44838804205258687,
      "lr": 8.305704108364301e-05
    },
    {
      "epoch": 16,
      "train_loss": 0.2685187572470078,
      "train_cosine": 0.5222604508583362,
      "val_loss": 0.33729647994041445,
      "val_cosine": 0.4444647073745728,
      "lr": 8.074524970549764e-05,
      "hit@1": 0.508695662021637,
      "hit@5": 0.656521737575531,
      "hit@10": 0.739130437374115
    },
    {
      "epoch": 17,
      "train_loss": 0.26388292220922616,
      "train_cosine": 0.5268688460955254,
      "val_loss": 0.3386379520098368,
      "val_cosine": 0.44208372632662457,
      "lr": 7.832766557397364e-05,
      "hit@1": 0.5,
      "hit@5": 0.6521739363670349,
      "hit@10": 0.747826099395752
    }
  ],
  "best_hit5": 0.665217399597168,
  "stopped_epoch": 18,
  "args": {
    "model_type": "memory_gru",
    "data": "artifacts/lvm/data_phase2/training_sequences_ctx100.npz",
    "epochs": 50,
    "batch_size": 16,
    "accumulation_steps": 16,
    "lr": 0.0001,
    "weight_decay": 0.0001,
    "device": "mps",
    "patience": 3,
    "alpha_infonce": 0.05,
    "temperature": 0.07,
    "min_coherence": 0.0,
    "min_length": 7,
    "output_dir": "artifacts/lvm/models_phase2b/run_500ctx_alpha05",
    "seed": 42
  },
  "trained_at": "2025-10-19T18:58:14.725759"
}