{
  "model_type": "memory_gru",
  "model_name": "Memory-Augmented GRU (Extended Context)",
  "history": [
    {
      "epoch": 1,
      "train_loss": 0.3651095919884168,
      "train_cosine": 0.3698599786712573,
      "val_loss": 0.3305487434069316,
      "val_cosine": 0.43940708637237547,
      "lr": 0.0001,
      "hit@1": 0.38260868191719055,
      "hit@5": 0.5565217137336731,
      "hit@10": 0.6304348111152649
    },
    {
      "epoch": 2,
      "train_loss": 0.3273510497349959,
      "train_cosine": 0.4484647764609408,
      "val_loss": 0.32039162317911785,
      "val_cosine": 0.4612207651138306,
      "lr": 9.990754267376514e-05
    },
    {
      "epoch": 3,
      "train_loss": 0.32051990697017085,
      "train_cosine": 0.46223742893108954,
      "val_loss": 0.3181670645872752,
      "val_cosine": 0.465134733915329,
      "lr": 9.963055062204608e-05
    },
    {
      "epoch": 4,
      "train_loss": 0.3171015572089415,
      "train_cosine": 0.4675303555451906,
      "val_loss": 0.3156564474105835,
      "val_cosine": 0.46652488509813944,
      "lr": 9.917016206459795e-05
    },
    {
      "epoch": 5,
      "train_loss": 0.31215593677300674,
      "train_cosine": 0.46907833356123696,
      "val_loss": 0.3134415209293365,
      "val_cosine": 0.4651061634222666,
      "lr": 9.852826883675633e-05
    },
    {
      "epoch": 6,
      "train_loss": 0.30566033273935317,
      "train_cosine": 0.4756413005865538,
      "val_loss": 0.3107363204161326,
      "val_cosine": 0.4672839164733887,
      "lr": 9.770750861548009e-05,
      "hit@1": 0.417391300201416,
      "hit@5": 0.6000000238418579,
      "hit@10": 0.647826075553894
    },
    {
      "epoch": 7,
      "train_loss": 0.30121727975515217,
      "train_cosine": 0.4799433641708816,
      "val_loss": 0.3088360667228699,
      "val_cosine": 0.468185689051946,
      "lr": 9.671125408057097e-05
    },
    {
      "epoch": 8,
      "train_loss": 0.2951577802117054,
      "train_cosine": 0.4853541092230725,
      "val_loss": 0.30753475427627563,
      "val_cosine": 0.4691651960213979,
      "lr": 9.554359905560885e-05
    },
    {
      "epoch": 9,
      "train_loss": 0.2915033542192899,
      "train_cosine": 0.48838330209255215,
      "val_loss": 0.3068255921204885,
      "val_cosine": 0.4679915169874827,
      "lr": 9.420934168555251e-05
    },
    {
      "epoch": 10,
      "train_loss": 0.28653016938613013,
      "train_cosine": 0.49414022633662597,
      "val_loss": 0.30686662793159486,
      "val_cosine": 0.4669126848379771,
      "lr": 9.27139647201328e-05
    },
    {
      "epoch": 11,
      "train_loss": 0.2819836939756687,
      "train_cosine": 0.49829970987943506,
      "val_loss": 0.3066083530584971,
      "val_cosine": 0.4653536558151245,
      "lr": 9.106361298405804e-05,
      "hit@1": 0.46086955070495605,
      "hit@5": 0.634782612323761,
      "hit@10": 0.695652186870575
    },
    {
      "epoch": 12,
      "train_loss": 0.27804715117582907,
      "train_cosine": 0.5022521823644637,
      "val_loss": 0.3065806011358897,
      "val_cosine": 0.46505826512972515,
      "lr": 8.926506812661104e-05
    },
    {
      "epoch": 13,
      "train_loss": 0.273424250804461,
      "train_cosine": 0.5078746988223147,
      "val_loss": 0.3074398934841156,
      "val_cosine": 0.4629182775815328,
      "lr": 8.732572075439773e-05
    },
    {
      "epoch": 14,
      "train_loss": 0.2687531746350802,
      "train_cosine": 0.5137800361101443,
      "val_loss": 0.30814843575159706,
      "val_cosine": 0.4598221977551778,
      "lr": 8.525354006175925e-05
    },
    {
      "epoch": 15,
      "train_loss": 0.2650057777762413,
      "train_cosine": 0.5175550790933462,
      "val_loss": 0.30904327630996703,
      "val_cosine": 0.4592099269231161,
      "lr": 8.305704108364301e-05
    },
    {
      "epoch": 16,
      "train_loss": 0.2610444826575426,
      "train_cosine": 0.5227161283676441,
      "val_loss": 0.3093326727549235,
      "val_cosine": 0.45781129598617554,
      "lr": 8.074524970549764e-05,
      "hit@1": 0.48260870575904846,
      "hit@5": 0.643478274345398,
      "hit@10": 0.7043478488922119
    },
    {
      "epoch": 17,
      "train_loss": 0.25730637644345944,
      "train_cosine": 0.527026401574795,
      "val_loss": 0.310622634490331,
      "val_cosine": 0.45462068915367126,
      "lr": 7.832766557397364e-05
    },
    {
      "epoch": 18,
      "train_loss": 0.25431043207645415,
      "train_cosine": 0.5307756864107572,
      "val_loss": 0.3117523670196533,
      "val_cosine": 0.450619641939799,
      "lr": 7.58142230608376e-05
    },
    {
      "epoch": 19,
      "train_loss": 0.25112314636890704,
      "train_cosine": 0.5342777678599726,
      "val_loss": 0.31228352189064024,
      "val_cosine": 0.45031559069951377,
      "lr": 7.321525044050772e-05
    },
    {
      "epoch": 20,
      "train_loss": 0.2469307248408978,
      "train_cosine": 0.5400839968369558,
      "val_loss": 0.31386155883471173,
      "val_cosine": 0.4468912959098816,
      "lr": 7.054142744895887e-05
    },
    {
      "epoch": 21,
      "train_loss": 0.24434618136057487,
      "train_cosine": 0.543181122495578,
      "val_loss": 0.31207351088523866,
      "val_cosine": 0.45408286452293395,
      "lr": 6.780374139839648e-05,
      "hit@1": 0.47826087474823,
      "hit@5": 0.6304348111152649,
      "hit@10": 0.6826087236404419
    },
    {
      "epoch": 22,
      "train_loss": 0.2417470674102123,
      "train_cosine": 0.5472279624297067,
      "val_loss": 0.3163619935512543,
      "val_cosine": 0.43970524668693545,
      "lr": 6.501344202803417e-05,
      "hit@1": 0.5,
      "hit@5": 0.665217399597168,
      "hit@10": 0.747826099395752
    },
    {
      "epoch": 23,
      "train_loss": 0.23934605454023067,
      "train_cosine": 0.5500213932532528,
      "val_loss": 0.3147660116354624,
      "val_cosine": 0.4477141042550405,
      "lr": 6.21819952765021e-05
    },
    {
      "epoch": 24,
      "train_loss": 0.23691430183557363,
      "train_cosine": 0.5539409463222211,
      "val_loss": 0.31604857444763185,
      "val_cosine": 0.4415371100107829,
      "lr": 5.932103616584572e-05
    },
    {
      "epoch": 25,
      "train_loss": 0.23416297710858858,
      "train_cosine": 0.5577346453299892,
      "val_loss": 0.31545040011405945,
      "val_cosine": 0.44416810671488444,
      "lr": 5.644232099072452e-05
    },
    {
      "epoch": 26,
      "train_loss": 0.23176990357729105,
      "train_cosine": 0.5612337011557358,
      "val_loss": 0.3149358411629995,
      "val_cosine": 0.44647018710772196,
      "lr": 5.355767900927554e-05,
      "hit@1": 0.48695650696754456,
      "hit@5": 0.6391304135322571,
      "hit@10": 0.717391312122345
    },
    {
      "epoch": 27,
      "train_loss": 0.22950905022712853,
      "train_cosine": 0.5649786921647878,
      "val_loss": 0.317241104443868,
      "val_cosine": 0.43913689454396565,
      "lr": 5.0678963834154346e-05,
      "hit@1": 0.4956521689891815,
      "hit@5": 0.6391304135322571,
      "hit@10": 0.717391312122345
    }
  ],
  "best_hit5": 0.665217399597168,
  "stopped_epoch": 28,
  "args": {
    "model_type": "memory_gru",
    "data": "artifacts/lvm/data_phase2/training_sequences_ctx100.npz",
    "epochs": 50,
    "batch_size": 16,
    "accumulation_steps": 16,
    "lr": 0.0001,
    "weight_decay": 0.0001,
    "device": "mps",
    "patience": 3,
    "alpha_infonce": 0.03,
    "temperature": 0.07,
    "min_coherence": 0.0,
    "min_length": 7,
    "output_dir": "artifacts/lvm/models_phase2/run_500ctx_warm",
    "seed": 42
  },
  "trained_at": "2025-10-19T17:31:51.638895"
}