{
  "model_type": "memory_gru",
  "model_name": "Memory-Augmented GRU (Extended Context)",
  "history": [
    {
      "epoch": 1,
      "train_loss": 0.39084755774621993,
      "train_cosine": 0.4346021172062901,
      "val_loss": 0.3648408345050282,
      "val_cosine": 0.46592869030104744,
      "lr": 0.0001,
      "hit@1": 0.31533101201057434,
      "hit@5": 0.4773519039154053,
      "hit@10": 0.5435540080070496
    },
    {
      "epoch": 2,
      "train_loss": 0.3598547875881195,
      "train_cosine": 0.46530571506119356,
      "val_loss": 0.3499409051405059,
      "val_cosine": 0.473845715324084,
      "lr": 9.990754267376514e-05
    },
    {
      "epoch": 3,
      "train_loss": 0.3456556557132733,
      "train_cosine": 0.4731028438906178,
      "val_loss": 0.3430323733223809,
      "val_cosine": 0.4790707098113166,
      "lr": 9.963055062204608e-05
    },
    {
      "epoch": 4,
      "train_loss": 0.33675798755312114,
      "train_cosine": 0.47895381555837757,
      "val_loss": 0.339761802719699,
      "val_cosine": 0.47606659597820705,
      "lr": 9.917016206459795e-05
    },
    {
      "epoch": 5,
      "train_loss": 0.3299132571685425,
      "train_cosine": 0.48333176057036087,
      "val_loss": 0.3372957565718227,
      "val_cosine": 0.47846900009446675,
      "lr": 9.852826883675633e-05
    },
    {
      "epoch": 6,
      "train_loss": 0.32420394765703303,
      "train_cosine": 0.48768700626981504,
      "val_loss": 0.3365758955478668,
      "val_cosine": 0.4749780578745736,
      "lr": 9.770750861548009e-05,
      "hit@1": 0.3789198696613312,
      "hit@5": 0.5662021040916443,
      "hit@10": 0.6341463327407837
    },
    {
      "epoch": 7,
      "train_loss": 0.3193896029940331,
      "train_cosine": 0.49061395389376766,
      "val_loss": 0.3351890742778778,
      "val_cosine": 0.47942136228084564,
      "lr": 9.671125408057097e-05
    },
    {
      "epoch": 8,
      "train_loss": 0.3147291559552999,
      "train_cosine": 0.49448572934227486,
      "val_loss": 0.33483079820871353,
      "val_cosine": 0.47617413103580475,
      "lr": 9.554359905560885e-05
    },
    {
      "epoch": 9,
      "train_loss": 0.3103171792746328,
      "train_cosine": 0.4976450451202808,
      "val_loss": 0.33499158339367974,
      "val_cosine": 0.47523565424813163,
      "lr": 9.420934168555251e-05
    },
    {
      "epoch": 10,
      "train_loss": 0.3056782786691152,
      "train_cosine": 0.5013257145143516,
      "val_loss": 0.33560890869961846,
      "val_cosine": 0.4721227851178911,
      "lr": 9.27139647201328e-05
    },
    {
      "epoch": 11,
      "train_loss": 0.3010623734617381,
      "train_cosine": 0.5046100611841714,
      "val_loss": 0.337033083041509,
      "val_cosine": 0.4705740784605344,
      "lr": 9.106361298405804e-05,
      "hit@1": 0.38675957918167114,
      "hit@5": 0.5897212624549866,
      "hit@10": 0.6437281966209412
    },
    {
      "epoch": 12,
      "train_loss": 0.29654669567896486,
      "train_cosine": 0.508641015542181,
      "val_loss": 0.33783652550644344,
      "val_cosine": 0.4683435145351622,
      "lr": 8.926506812661104e-05
    },
    {
      "epoch": 13,
      "train_loss": 0.29194457201581253,
      "train_cosine": 0.512483733449558,
      "val_loss": 0.33999866661098266,
      "val_cosine": 0.46489553567436004,
      "lr": 8.732572075439773e-05
    },
    {
      "epoch": 14,
      "train_loss": 0.28734247755524545,
      "train_cosine": 0.5165564166872126,
      "val_loss": 0.3399918352564176,
      "val_cosine": 0.4658290793498357,
      "lr": 8.525354006175925e-05
    },
    {
      "epoch": 15,
      "train_loss": 0.28281723765581385,
      "train_cosine": 0.5210175109167954,
      "val_loss": 0.3418586080272992,
      "val_cosine": 0.4612252149317,
      "lr": 8.305704108364301e-05
    },
    {
      "epoch": 16,
      "train_loss": 0.27855427286388706,
      "train_cosine": 0.5250302448914881,
      "val_loss": 0.34257644828822875,
      "val_cosine": 0.4650680869817734,
      "lr": 8.074524970549764e-05,
      "hit@1": 0.38850173354148865,
      "hit@5": 0.5722996592521667,
      "hit@10": 0.6254355311393738
    },
    {
      "epoch": 17,
      "train_loss": 0.2741426093844068,
      "train_cosine": 0.5294123710862619,
      "val_loss": 0.3466290757060051,
      "val_cosine": 0.44797927555110717,
      "lr": 7.832766557397364e-05,
      "hit@1": 0.40069687366485596,
      "hit@5": 0.5932055711746216,
      "hit@10": 0.6515679359436035
    },
    {
      "epoch": 18,
      "train_loss": 0.27044362936964716,
      "train_cosine": 0.5327422032968916,
      "val_loss": 0.34520860844188267,
      "val_cosine": 0.45625244246588814,
      "lr": 7.58142230608376e-05
    },
    {
      "epoch": 19,
      "train_loss": 0.2666396486685372,
      "train_cosine": 0.5368180398601494,
      "val_loss": 0.3446894155608283,
      "val_cosine": 0.4621431562635634,
      "lr": 7.321525044050772e-05
    },
    {
      "epoch": 20,
      "train_loss": 0.2637550505599001,
      "train_cosine": 0.539987414060362,
      "val_loss": 0.3478068858385086,
      "val_cosine": 0.4490458650721444,
      "lr": 7.054142744895887e-05
    },
    {
      "epoch": 21,
      "train_loss": 0.26095943263625215,
      "train_cosine": 0.5429755440068321,
      "val_loss": 0.3482061243719525,
      "val_cosine": 0.44848042395379806,
      "lr": 6.780374139839648e-05,
      "hit@1": 0.38675957918167114,
      "hit@5": 0.5827525854110718,
      "hit@10": 0.645470380783081
    },
    {
      "epoch": 22,
      "train_loss": 0.2583398744694589,
      "train_cosine": 0.5457785157227295,
      "val_loss": 0.3467799847324689,
      "val_cosine": 0.45749183661407894,
      "lr": 6.501344202803417e-05,
      "hit@1": 0.38850173354148865,
      "hit@5": 0.5688153505325317,
      "hit@10": 0.6289198398590088
    }
  ],
  "best_hit5": 0.5932055711746216,
  "stopped_epoch": 23,
  "args": {
    "model_type": "memory_gru",
    "data": "artifacts/lvm/data_extended/training_sequences_ctx100.npz",
    "epochs": 50,
    "batch_size": 32,
    "accumulation_steps": 8,
    "lr": 0.0001,
    "weight_decay": 0.0001,
    "device": "mps",
    "patience": 3,
    "alpha_infonce": 0.05,
    "temperature": 0.07,
    "min_coherence": 0.0,
    "min_length": 7,
    "output_dir": "artifacts/lvm/models_final/memory_gru_consultant_recipe",
    "seed": 42
  },
  "trained_at": "2025-10-19T16:33:18.590730"
}