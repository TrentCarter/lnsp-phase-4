{
  "model_type": "memory_gru",
  "model_name": "Memory-Augmented GRU (Extended Context)",
  "history": [
    {
      "epoch": 1,
      "train_loss": 0.3682208768157072,
      "train_cosine": 0.3329349219105964,
      "val_loss": 0.31817391912142434,
      "val_cosine": 0.42832234501838684,
      "lr": 0.0001,
      "hit@1": 0.539130449295044,
      "hit@5": 0.634782612323761,
      "hit@10": 0.730434775352478
    },
    {
      "epoch": 2,
      "train_loss": 0.3260651928509853,
      "train_cosine": 0.41890359225199203,
      "val_loss": 0.30032315055529274,
      "val_cosine": 0.4653525292873383,
      "lr": 9.990754267376514e-05
    },
    {
      "epoch": 3,
      "train_loss": 0.3115223934946134,
      "train_cosine": 0.44847568523052134,
      "val_loss": 0.29324345191319784,
      "val_cosine": 0.4807752132415771,
      "lr": 9.963055062204608e-05
    },
    {
      "epoch": 4,
      "train_loss": 0.30537711095440295,
      "train_cosine": 0.4609438287195312,
      "val_loss": 0.29032348891099297,
      "val_cosine": 0.4871254781881968,
      "lr": 9.917016206459795e-05
    },
    {
      "epoch": 5,
      "train_loss": 0.30171246664930684,
      "train_cosine": 0.46730787717094724,
      "val_loss": 0.2883342792590459,
      "val_cosine": 0.49028344750404357,
      "lr": 9.852826883675633e-05
    },
    {
      "epoch": 6,
      "train_loss": 0.29909656456736633,
      "train_cosine": 0.4714349575282987,
      "val_loss": 0.2865129679441452,
      "val_cosine": 0.4912902057170868,
      "lr": 9.770750861548009e-05,
      "hit@1": 0.5130434632301331,
      "hit@5": 0.678260862827301,
      "hit@10": 0.747826099395752
    },
    {
      "epoch": 7,
      "train_loss": 0.29482693681421207,
      "train_cosine": 0.47475445917410436,
      "val_loss": 0.2864078164100647,
      "val_cosine": 0.4875111063321432,
      "lr": 9.671125408057097e-05
    },
    {
      "epoch": 8,
      "train_loss": 0.291354881931645,
      "train_cosine": 0.47646500967269706,
      "val_loss": 0.2854753851890564,
      "val_cosine": 0.4878308633963267,
      "lr": 9.554359905560885e-05
    },
    {
      "epoch": 9,
      "train_loss": 0.28724700016106747,
      "train_cosine": 0.4817712551863621,
      "val_loss": 0.28504483997821806,
      "val_cosine": 0.4871509830156962,
      "lr": 9.420934168555251e-05
    },
    {
      "epoch": 10,
      "train_loss": 0.28342050718244655,
      "train_cosine": 0.48573461891144754,
      "val_loss": 0.28464366793632506,
      "val_cosine": 0.48690531849861146,
      "lr": 9.27139647201328e-05
    },
    {
      "epoch": 11,
      "train_loss": 0.27861002665157464,
      "train_cosine": 0.4910702243331792,
      "val_loss": 0.2841009149948756,
      "val_cosine": 0.48709059357643125,
      "lr": 9.106361298405804e-05,
      "hit@1": 0.5565217137336731,
      "hit@5": 0.739130437374115,
      "hit@10": 0.791304349899292
    },
    {
      "epoch": 12,
      "train_loss": 0.2745075493819954,
      "train_cosine": 0.496272751527239,
      "val_loss": 0.2845195084810257,
      "val_cosine": 0.48470773895581565,
      "lr": 8.926506812661104e-05
    },
    {
      "epoch": 13,
      "train_loss": 0.2706107225760009,
      "train_cosine": 0.500392060871272,
      "val_loss": 0.28409299353758494,
      "val_cosine": 0.4853422780831655,
      "lr": 8.732572075439773e-05
    },
    {
      "epoch": 14,
      "train_loss": 0.2662857795177504,
      "train_cosine": 0.5062056987784633,
      "val_loss": 0.28547977209091185,
      "val_cosine": 0.4804890215396881,
      "lr": 8.525354006175925e-05
    },
    {
      "epoch": 15,
      "train_loss": 0.2621612626221753,
      "train_cosine": 0.5103766398374425,
      "val_loss": 0.28436335225900017,
      "val_cosine": 0.4835683266321818,
      "lr": 8.305704108364301e-05
    },
    {
      "epoch": 16,
      "train_loss": 0.2589961885250816,
      "train_cosine": 0.5154789041641148,
      "val_loss": 0.2862772732973099,
      "val_cosine": 0.47770079771677654,
      "lr": 8.074524970549764e-05,
      "hit@1": 0.6173912882804871,
      "hit@5": 0.7565217614173889,
      "hit@10": 0.8173912763595581
    },
    {
      "epoch": 17,
      "train_loss": 0.25505427115185314,
      "train_cosine": 0.5207116786361665,
      "val_loss": 0.2860531737407049,
      "val_cosine": 0.47820520401000977,
      "lr": 7.832766557397364e-05
    },
    {
      "epoch": 18,
      "train_loss": 0.25176915630351665,
      "train_cosine": 0.5245233148105384,
      "val_loss": 0.28685352206230164,
      "val_cosine": 0.4761761824289958,
      "lr": 7.58142230608376e-05
    },
    {
      "epoch": 19,
      "train_loss": 0.24876401336618173,
      "train_cosine": 0.5294520353624064,
      "val_loss": 0.2878678262233734,
      "val_cosine": 0.47331989208857217,
      "lr": 7.321525044050772e-05
    },
    {
      "epoch": 20,
      "train_loss": 0.24505797444387925,
      "train_cosine": 0.5338657211887741,
      "val_loss": 0.28718653122584026,
      "val_cosine": 0.4760295510292053,
      "lr": 7.054142744895887e-05
    },
    {
      "epoch": 21,
      "train_loss": 0.2415992487077565,
      "train_cosine": 0.5389321855334347,
      "val_loss": 0.28830178678035734,
      "val_cosine": 0.4727375268936157,
      "lr": 6.780374139839648e-05,
      "hit@1": 0.591304361820221,
      "hit@5": 0.747826099395752,
      "hit@10": 0.8086956739425659
    },
    {
      "epoch": 22,
      "train_loss": 0.23911268801190133,
      "train_cosine": 0.5425740193951037,
      "val_loss": 0.2885472188393275,
      "val_cosine": 0.47243667046229043,
      "lr": 6.501344202803417e-05,
      "hit@1": 0.591304361820221,
      "hit@5": 0.747826099395752,
      "hit@10": 0.8086956739425659
    }
  ],
  "best_hit5": 0.7565217614173889,
  "stopped_epoch": 23,
  "args": {
    "model_type": "memory_gru",
    "data": "artifacts/lvm/data_phase3/training_sequences_ctx100.npz",
    "epochs": 50,
    "batch_size": 8,
    "accumulation_steps": 32,
    "lr": 0.0001,
    "weight_decay": 0.0001,
    "device": "mps",
    "patience": 3,
    "alpha_infonce": 0.03,
    "temperature": 0.07,
    "min_coherence": 0.0,
    "min_length": 7,
    "output_dir": "artifacts/lvm/models_phase3/run_1000ctx_pilot",
    "seed": 42
  },
  "trained_at": "2025-10-19T21:04:26.154997"
}