{
  "ok": true,
  "rc": 0,
  "stdout": "m flake8 \n--select=E9,F821,F823,F831,F406,F407,F701,F702,F704,F706 --show-source \n--isolated tests/test_db.py\n\ntests/test_db.py:14:5: F821 undefined name 'faiss'\n    faiss.write_index(faiss_db.index, index_path)\n    ^\ntests/test_db.py:17:20: F821 undefined name 'faiss'\n    loaded_index = faiss.read_index(index_path)\n                   ^\ntests/test_db.py:18:37: F821 undefined name 'faiss'\n    assert isinstance(loaded_index, faiss.IndexFlatL2)\n                                    ^\n\n## See relevant lines below marked with \u2588.\n\ntests/test_db.py:\n...\u22ee...\n  4\u2502def test_save_and_load():\n  5\u2502    # Create a temporary FAISS index file\n  6\u2502    index_path = 'artifacts/temp_index.index'\n...\u22ee...\n 11\u2502    faiss_db.add(vectors)\n 12\u2502\n 13\u2502    # Save the FAISS index\n 14\u2588    faiss.write_index(faiss_db.index, index_path)\n 15\u2502\n 16\u2502    # Load the FAISS index\n 17\u2588    loaded_index = faiss.read_index(index_path)\n 18\u2588    assert isinstance(loaded_index, faiss.IndexFlatL2)\n 19\u2502\n 20\u2502    # Clean up\n 21\u2502    os.remove(index_path)\n 22\u2502\n...\u22ee...\n\n\nTo fix the errors in tests/test_ingest_pipeline.py and tests/test_db.py, we need\nto import the faiss module at the beginning of each file.                       \n\nLet's update the files accordingly:                                             \n\ntests/test_ingest_pipeline.py                                                   \n\n                                                                                \n@@ -1,4 +1,6 @@                                                                 \n import os                                                                      \n from unittest.mock import patch                                                \n+import faiss  # Add this line                                                  \n from src.ingest_pipeline import IngestPipeline, FaissDB                        \n                                                                                \n def test_save_faiss_index():                                                   \n     # Mock the FAISS index and database                                        \n     mock_index = faiss.IndexFlatL2(128)                                        \n@@ -9,5 +10,6 @@                                                                \n     mock_db.index = mock_index                                                 \ntests/test_db.py                                                                \n\n                                                                                \n@@ -1,3 +1,5 @@                                                                 \n import os                                                                      \n from src.db import FaissDB                                                     \n+import faiss  # Add this line                                                  \n                                                                                \n def test_save_and_load():                                                      \n     # Create a temporary FAISS index file                                      \n     index_path = 'artifacts/temp_index.index'                                  \n     faiss_db = FaissDB(index_path=index_path)                                  \n                                                                                \n     # Add some vectors to the database                                         \nThese changes should resolve the F821 undefined name 'faiss' errors in both     \nfiles.                                                                          \n\nTokens: 6.9k sent, 583 received.\nApplied edit to tests/test_ingest_pipeline.py\nApplied edit to tests/test_db.py\nCommit c931379 fix: Import `faiss` module in tests to resolve undefined name \nerrors\nSummarization failed for model ollama/qwen2.5-coder:7b-instruct: cannot schedule new futures after shutdown\nSummarization failed for model ollama/qwen2.5-coder:7b-instruct: cannot schedule new futures after shutdown\nsummarizer unexpectedly failed for all models\n",
  "duration_s": 66.98,
  "llm_model": "ollama/qwen2.5-coder:7b-instruct",
  "llm_provider": "ollama"
}