[Consultant] Implement Neo4j per neo4j_usage.md

[Consultant] Create test fiunctions for Neo4J

[Architect] ✅ COMPLETED: Roll Neo4j Into make ingest* functions to clear these comments you recently reported:
"⏺ Neo4j is not installed. The script now correctly handles this situation:

  Summary of Changes:

  1. Neo4j is now properly marked as optional - The ingestion will proceed without it, just with graph features disabled.
  2. Better Neo4j handling:
    - Checks if Neo4j is installed via brew
    - If installed, offers to start it via brew services start neo4j
    - If not installed, tells you how to install it: brew install neo4j
    - Waits up to 30 seconds for Neo4j to start with progress updates
    - Proceeds without Neo4j if it's not available
  3. New environment variable: SKIP_NEO4J=1 to skip Neo4j prompts entirely

  Usage Options:

  # Run with prompts (will ask about Neo4j if not running)
  make ingest-all

  # Skip Neo4j entirely and proceed without graph features
  SKIP_NEO4J=1 make ingest-all

  # Fresh start without Neo4j
  FRESH_START=1 SKIP_NEO4J=1 make ingest-all

  # If you want to install Neo4j for full graph features
  brew install neo4j"

[Programmer] Neo4j Testing Tasks
- [X] Draft fixture loading minimal Concept/RELATES_TO graph into test Neo4j container or test double.
- [X] Add unit test for `db_neo4j.insert_relation_triple` to assert MERGE idempotency and property preservation.
- [X] Add regression test covering constraint violation handling (duplicate cpe_id) with clear failure messaging.
- [ ] Write integration test skeleton gated by `pytest.importorskip("neo4j")` that exercises `/graph/search` happy-path. (Skipped: API not yet implemented)
- [X] Verify tests clean up created nodes/relationships between runs to keep dev graph deterministic.

[Cascade] Completed the Neo4j testing tasks. I created `tests/test_neo4j.py` with a fixture to manage a test database connection and ensure a clean state for each run. I added tests to confirm that relation insertion is idempotent and that duplicate concept creations are handled gracefully by the uniqueness constraint. The test fixture also ensures all test data is removed after the suite runs. I skipped the integration test for the `/graph/search` endpoint as the API is not yet implemented.

## ✅ ARCHITECT TASK COMPLETION REPORT

**Task**: Roll Neo4j Into make ingest* functions

**Status**: ✅ COMPLETED

**Implementation Summary**:

### 1. Created Shared Service Management (`scripts/check_services.sh`)
- **Unified service checking**: PostgreSQL (required) and Neo4j (optional)
- **Auto-start capabilities**: Attempts to start services via brew services
- **Interactive and non-interactive modes**: Supports AUTO_START and SKIP_NEO4J flags
- **Proper error handling**: Clear messages and exit codes

### 2. Updated Both Ingestion Scripts

**`make ingest-10k` (scripts/ingest_10k.sh)**:
- Replaced basic service warnings with comprehensive service management
- Now checks and optionally starts PostgreSQL and Neo4j
- Properly fails if PostgreSQL is unavailable

**`make ingest-all` (scripts/ingest_comprehensive.sh)**:
- Refactored to use shared service checking logic
- Eliminated duplicate service management code
- Consistent behavior across all ingestion commands

### 3. Environment Variable Support

Added comprehensive environment variable support:
- `SKIP_NEO4J=1`: Skip Neo4j entirely, proceed without graph features
- `AUTO_START=1`: Auto-start services without interactive prompts
- `FRESH_START=1`: Start fresh without prompting about existing vectors
- `AUTO_RESUME=1`: Auto-resume from existing vectors

### 4. Usage Examples

```bash
# Standard ingestion with service checks
make ingest-10k
make ingest-all

# Skip Neo4j for faster CI/automated runs
SKIP_NEO4J=1 make ingest-all

# Fully automated fresh start
FRESH_START=1 SKIP_NEO4J=1 AUTO_START=1 make ingest-all
```

### 5. Key Improvements

- **No more service-related failures**: Both ingestion commands now properly check services
- **Consistent user experience**: Same service checking behavior across all ingest commands
- **Better automation support**: Environment flags for CI/CD pipelines
- **Clear messaging**: Users know exactly what services are required vs optional
- **Graceful degradation**: Proceeds without Neo4j when not available

### 6. Testing Verified

✅ Service check script works independently
✅ Both make targets now use shared service management
✅ PostgreSQL checking and auto-start works
✅ Neo4j optional handling works correctly
✅ Environment flags work as expected

**Result**: The Neo4j integration issues mentioned in the sprint are now completely resolved. All make ingest* functions have proper service management that handles Neo4j gracefully while ensuring PostgreSQL is available.
