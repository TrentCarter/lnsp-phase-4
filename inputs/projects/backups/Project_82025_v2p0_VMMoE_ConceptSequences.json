{
  "project": {
    "name": "VMMoE_v2p0_ConceptSequences",
    "version": "2.0",
    "description": "Revolutionary: Concept Sequence Training - Coherent 128-concept sequences from APPS dataset with temporal learning",
    "timestamp": "2025-08-20T03:30:00",
    "author": "AI Assistant + User",
    "tags": ["VMMoE", "concept_sequences", "temporal_learning", "apps_dataset", "sequence_packing"],
    "metadata": {
      "id": "v2p0_concept_sequences",
      "experiment_type": "coherent_sequence_training",
      "baseline": "v1p26_single_concepts",
      "key_innovation": "128_concept_coherent_sequences_with_packing",
      "data_architecture_alignment": "mamba_temporal_learning"
    }
  },
  "training": {
    "patience": 3,
    "min_delta": 0.001,
    "save_every_n_epochs": 3,
    "early_stopping_metric": "sequence_perplexity",
    "early_stopping_mode": "min",
    "early_stopping_patience": 2,
    "training_params": {
      "batch_size": 8,
      "num_workers": 2,
      "epochs": 5,
      "steps_per_epoch": 1000,
      "validation_frequency": 1,
      "checkpoint_frequency": 250,
      "device_priority": ["mps", "cuda", "cpu"],
      "mixed_precision": false,
      "compile_model": false,
      "seed": 42,
      "deterministic": false
    },
    "architecture": {
      "mamba_config": {
        "d_model": 768,
        "n_layers": 8,
        "d_state": 16,
        "d_conv": 4,
        "expand": 2.0
      },
      "positional_config": {
        "mode": "learned",
        "max_len": 128,
        "dropout": 0.1,
        "learned_config": {
          "embedding_dim": 768,
          "max_position_embeddings": 128
        }
      },
      "sequence_config": {
        "sequence_length": 128,
        "concept_embedding_dim": 768,
        "next_concept_prediction": true,
        "masked_concept_probability": 0.15,
        "sequence_packing": {
          "enabled": true,
          "pack_multiple_sequences": true,
          "padding_token_id": 0,
          "attention_mask_enabled": true
        }
      },
      "peft_config": {
        "enabled": true,
        "lora_config": {
          "r": 16,
          "lora_alpha": 32,
          "lora_dropout": 0.1,
          "target_modules": ["in_proj", "out_proj", "x_proj", "dt_proj"],
          "bias": "none",
          "task_type": "CAUSAL_LM",
          "init_lora_weights": "gaussian"
        },
        "freeze_base": false,
        "unfreeze_layers": ["output_projection", "prediction_head"]
      }
    },
    "loss_config": {
      "loss_type": "next_concept_prediction",
      "prediction_config": {
        "cross_entropy_weight": 0.7,
        "masked_lm_weight": 0.3,
        "sequence_coherence_weight": 0.1,
        "label_smoothing": 0.1
      },
      "auxiliary_losses": {
        "concept_similarity_loss": 0.1,
        "sequence_order_loss": 0.05,
        "domain_consistency_loss": 0.05
      },
      "normalization_enforcement": {
        "enabled": true,
        "l2_penalty_weight": 0.001,
        "unit_norm_final": true,
        "stability_epsilon": 1e-8
      }
    },
    "optimization": {
      "optimizer": "AdamW",
      "learning_rate": 5e-05,
      "weight_decay": 0.01,
      "gradient_clipping": 1.0,
      "warmup_steps": 100,
      "scheduler": "cosine",
      "betas": [0.9, 0.95],
      "eps": 1e-08,
      "gradient_accumulation_steps": 4
    },
    "data": {
      "batch_size": 8,
      "sequence_length": 128,
      "num_workers": 2,
      "shuffle": true,
      "drop_last": true,
      "data_type": "concept_sequences",
      "concept_sequence_databases": [
        "data/databases/concept_sequences_768_vectors"
      ],
      "sequence_metadata_db": "data/databases/concept_sequences_metadata.db",
      "sequence_packing": {
        "enabled": true,
        "max_sequences_per_batch": 4,
        "padding_strategy": "longest",
        "truncation_strategy": "longest_first",
        "pack_efficiency_target": 0.9
      },
      "domain_filtering": {
        "enabled": true,
        "allowed_domains": ["Programming", "Algorithms"],
        "domain_balancing": true
      },
      "data_augmentation": {
        "concept_masking": {
          "enabled": true,
          "mask_probability": 0.15,
          "mask_token": "[MASK]"
        },
        "sequence_shuffling": {
          "enabled": false,
          "shuffle_probability": 0.0
        }
      }
    }
  },
  "mlflow": {
    "experiment_name": "VMMoE_ConceptSequences_v2p0",
    "run_name": "concept_sequences_128_apps",
    "run_name_prefix": "v2p0_seq128",
    "tracking_uri": "sqlite:///mlflow.db",
    "log_model": true,
    "log_artifacts": true,
    "tags": {
      "version": "2.0",
      "architecture": "VMMoE_ConceptSequences",
      "training": "sequence_based",
      "sequence_length": "128",
      "dataset": "apps_concept_sequences",
      "experiment": "temporal_concept_learning"
    }
  },
  "outputs": {
    "model_save_path": "output/vmmoe_concept_sequences_v2p0",
    "logs_path": "output/logs",
    "plots_path": "output/plots",
    "checkpoints_path": "output/checkpoints"
  },
  "checkpointing": {
    "resume_from_checkpoint": null,
    "save_optimizer_state": true,
    "save_scheduler_state": true,
    "checkpoint_format": "pytorch"
  },
  "monitoring": {
    "log_every_n_steps": 25,
    "validate_every_n_steps": 100,
    "log_gradients": false,
    "log_learning_rate": true,
    "log_loss_components": true,
    "track_memory_usage": true,
    "sequence_metrics": {
      "concept_prediction_accuracy": true,
      "sequence_coherence_score": true,
      "domain_classification_accuracy": true,
      "next_concept_perplexity": true
    }
  },
  "evaluation": {
    "validation_split": 0.2,
    "metrics": [
      "sequence_perplexity",
      "concept_prediction_accuracy",
      "masked_concept_accuracy",
      "sequence_coherence_score",
      "domain_consistency",
      "analogical_reasoning_score"
    ],
    "save_predictions": true,
    "compute_analogies": true,
    "sequence_test_cases": [
      {
        "input_sequence": ["problem statement", "algorithm design", "implementation"],
        "expected_next": "testing and validation"
      },
      {
        "input_sequence": ["array initialization", "loop iteration", "element comparison"],
        "expected_next": "conditional update"
      },
      {
        "input_sequence": ["function definition", "parameter validation", "core logic"],
        "expected_next": "return statement"
      }
    ]
  }
}