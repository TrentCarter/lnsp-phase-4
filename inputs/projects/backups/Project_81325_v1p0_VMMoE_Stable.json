{
  "project": {
    "metadata": {
      "id": "VMMoE_Stable_Test",
      "name": "Stable VMMoE Training Configuration",
      "description": "Configuration that fixes d_ap increasing issue",
      "version": "1.0.0",
      "created_date": "2025-08-13",
      "training_date": "2025-08-13T21:37",
      "notes": "First successful VMMoE training run - baseline configuration"
    },
    "model": "sentence-transformers/gtr-t5-base",
    "local_model_path": "data/teacher_models/gtr-t5-base"
  },
  "training": {
    "architecture": {
      "mamba_config": {
        "d_model": 768,
        "n_layers": 4,
        "d_state": 16,
        "d_conv": 4,
        "expand": 1.5,
        "dt_rank": "auto",
        "dt_min": 0.001,
        "dt_max": 0.1,
        "dt_init": "random",
        "dt_scale": 1.0,
        "bias": false,
        "conv_bias": true
      },
      "positional_config": {
        "mode": "learned",
        "max_len": 512
      }
    },
    "loss_config": {
      "loss_type": "triplet",
      "margin_start": 0.05,
      "margin_end": 0.2,
      "margin_schedule": "linear",
      "cosine_weight": 0.8,
      "mse_weight": 0.1,
      "contrastive_weight": 0.1,
      "orthogonality_weight": 0.001
    },
    "optimization": {
      "optimizer": "AdamW",
      "learning_rate": 1e-06,
      "weight_decay": 0.01,
      "gradient_clipping": 0.5,
      "warmup_steps": 100,
      "scheduler": "cosine"
    },
    "data": {
      "batch_size": 4,
      "sequence_length": 16,
      "num_workers": 0,
      "shuffle": true,
      "drop_last": true,
      "concept_databases": [
        "data/databases/concept_vector_db_768_training"
      ]
    },
    "training_params": {
      "epochs": 5,
      "steps_per_epoch": 20,
      "validation_frequency": 5,
      "checkpoint_frequency": 20,
      "device_priority": [
        "mps",
        "cuda",
        "cpu"
      ]
    }
  },
  "evaluation": {
    "validation_split": 0.1,
    "metrics": [
      "retrieval_at_1",
      "mean_cosine_similarity",
      "triplet_accuracy"
    ]
  },
  "mlflow": {
    "tracking_uri": "http://localhost:5006",
    "experiment_name": "vmmoe_stable",
    "run_name_prefix": "stable_test",
    "log_models": true,
    "log_metrics_frequency": 1
  },
  "checkpointing": {
    "checkpoint_dir": "output/vmmoe_stable",
    "save_best": true,
    "embed_config": true
  },
  "results": {
    "training_time": "53.1s",
    "final_train_loss": 0.09218,
    "best_val_loss": 0.09186,
    "total_steps": 560,
    "dataset_used": "500/60000 vectors (0.8%)",
    "checkpoints_created": [
      "best_model.pth", 
      "20250813T213753_SN000011_VMamba_epoch4.pth"
    ]
  }
}