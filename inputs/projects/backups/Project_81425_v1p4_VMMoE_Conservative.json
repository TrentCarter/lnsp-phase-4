{
  "project": {
    "metadata": {
      "id": "VMMoE_Production_V1p4_Conservative",
      "name": "VMMoE Production Training v1.4 - Conservative Approach",
      "description": "Back to v1.1 proven config with early stopping to prevent overfitting",
      "version": "1.4.0",
      "created_date": "2025-08-14",
      "training_date": "2025-08-14T18:xx",
      "notes": "Stop training early to preserve semantic quality - target loss ~0.005-0.01"
    },
    "model": "sentence-transformers/gtr-t5-base",
    "local_model_path": "data/teacher_models/gtr-t5-base"
  },
  "training": {
    "architecture": {
      "mamba_config": {
        "d_model": 768,
        "n_layers": 4,
        "d_state": 16,
        "d_conv": 4,
        "expand": 1.5,
        "dt_rank": "auto",
        "dt_min": 0.001,
        "dt_max": 0.1,
        "dt_init": "random",
        "dt_scale": 1.0,
        "bias": false,
        "conv_bias": true
      },
      "positional_config": {
        "mode": "learned",
        "max_len": 512
      }
    },
    "loss_config": {
      "loss_type": "triplet",
      "margin_start": 0.05,
      "margin_end": 0.2,
      "margin_schedule": "linear",
      "cosine_weight": 0.8,
      "mse_weight": 0.1,
      "contrastive_weight": 0.1,
      "orthogonality_weight": 0.001
    },
    "optimization": {
      "optimizer": "AdamW",
      "learning_rate": 5e-05,
      "weight_decay": 0.01,
      "gradient_clipping": 0.5,
      "warmup_steps": 500,
      "scheduler": "cosine"
    },
    "data": {
      "batch_size": 16,
      "sequence_length": 16,
      "num_workers": 0,
      "shuffle": true,
      "drop_last": true,
      "concept_databases": [
        "data/databases/concept_vector_db_768_training"
      ]
    },
    "training_params": {
      "epochs": 50,
      "steps_per_epoch": 500,
      "validation_frequency": 5,
      "checkpoint_frequency": 100,
      "device_priority": [
        "mps",
        "cuda",
        "cpu"
      ]
    },
    "early_stopping": {
      "enabled": true,
      "patience": 3,
      "min_delta": 0.001,
      "monitor": "val/loss",
      "mode": "min",
      "min_epochs": 3,
      "loss_target": 0.01,
      "loss_target_enabled": true,
      "verbose": true
    }
  },
  "evaluation": {
    "validation_split": 0.05,
    "metrics": [
      "retrieval_at_1",
      "mean_cosine_similarity",
      "triplet_accuracy"
    ]
  },
  "mlflow": {
    "tracking_uri": "http://localhost:5006",
    "experiment_name": "vmmoe_stable_v1p4",
    "run_name_prefix": "conservative_v1p4",
    "log_models": true,
    "log_metrics_frequency": 1
  },
  "checkpointing": {
    "checkpoint_dir": "output/vmmoe_stable_v1p4",
    "save_best": true,
    "embed_config": true
  },
  "strategy": {
    "approach": "Conservative training to preserve semantic quality",
    "target_loss": "0.005 - 0.01 (not near zero)",
    "key_changes": {
      "early_stopping": "Aggressive - stop at loss 0.01 or 3 epochs patience",
      "learning_rate": "Back to proven 5e-05",
      "scheduler": "Simple cosine (no restarts)",
      "batch_size": "Back to 16 (proven)",
      "loss_target": "0.01 (prevent over-optimization)"
    },
    "philosophy": "Stop training while model still generalizes well"
  }
}